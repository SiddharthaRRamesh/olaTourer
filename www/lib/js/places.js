angular.module("ion-google-place",[]).directive("ionGooglePlace",["$ionicTemplateLoader","$ionicBackdrop","$ionicPlatform","$q","$timeout","$rootScope","$document",function(e,t,n,o,i,a,l){return{require:"?ngModel",restrict:"E",template:'<input type="text" readonly="readonly" class="ion-google-place home-ipt circularLight inpPlacesFld" autocomplete="off">',replace:!0,scope:{ngModel:"=?"},link:function(o,a,c,r){var s;o.locations=[];var d=new google.maps.Geocoder,u=void 0,p=['<div class="ion-google-place-container">','<div class="bar bar-header item-input-inset" style="height:73px;margin-top: -11px;">','<md-text-float style="width:90%; margin-bottom:8px;"label="Enter Place" class="google-place-search circularLight" ng-model="searchQuery" type="text">',"</md-text-float>",'<button class="button button-icon icon ion-android-close" style="margin-top: 8px;margin-right: -13px;">',"</button>","</div>",'<ion-content class="has-header has-header">','<ion-list class="places-google-list">','<div data-tap-disabled="true" class="item item-icon-left circularMedium" ng-repeat="location in locations" type="item-text-wrap" ng-click="selectLocation(location)">','<i class="icon ion-android-pin"></i>',"{{location.formatted_address}}","</div>","</ion-list>","</ion-content>","</div>"].join(""),m=e.compile({template:p,scope:o,appendTo:l[0].body});m.then(function(e){var l=angular.element(e.element.find("input"));o.selectLocation=function(n){r.$setViewValue(n),r.$render(),e.element.css("display","none"),t.release(),s&&(s(),s=null)},o.$watch("searchQuery",function(e){u&&i.cancel(u),u=i(function(){if(e){e.length<3;var t=o.geocodeOptions||{};t.address=e,d.geocode(t,function(e,t){t==google.maps.GeocoderStatus.OK&&o.$apply(function(){o.locations=e})})}},350)});var c=function(o){o.preventDefault(),o.stopPropagation(),t.retain(),s=n.registerBackButtonAction(closeOnBackButton,250),e.element.css("display","block"),l[0].focus(),setTimeout(function(){l[0].focus()},0)},p=function(){o.searchQuery="",t.release(),e.element.css("display","none"),s&&(s(),s=null)};closeOnBackButton=function(n){n.preventDefault(),e.element.css("display","none"),t.release(),s&&(s(),s=null)},a.bind("click",c),a.bind("touchend",c),e.element.find("button").bind("click",p)}),c.placeholder&&a.attr("placeholder",c.placeholder),r.$formatters.unshift(function(e){return e?e:""}),r.$parsers.unshift(function(e){return e}),r.$render=function(){a.val(r.$viewValue?r.$viewValue.formatted_address||"":"")},o.$on("$destroy",function(){s&&(s(),s=null)})}}}]);