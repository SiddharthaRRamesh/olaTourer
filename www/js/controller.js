var OlaTourerController=angular.module("OlaTourerController",[]);OlaTourerController.controller("SignUpController",["$scope","$mdToast","$state","$cordovaFacebook","$cordovaGooglePlus","$ionicLoading","LocalStorageService",function(t,e,o,i,n,a,s){t.toastPosition={bottom:!0,top:!1,left:!0,right:!0},t.getToastPosition=function(){return Object.keys(t.toastPosition).filter(function(e){return t.toastPosition[e]}).join(" ")},t.fbLogin=function(){i.login(["public_profile","email","user_friends"]).then(function(){i.api("me?fields=id,name,picture",[]).then(function(i){var n=({id:i.id,name:i.name,pic:i.picture.data.url},e.simple().content("YOU HAVE BEEN SIGNED IN").action("").highlightAction(!1).position(t.getToastPosition()));e.show(n).then(function(){}),s.set("isSignedIn",!0),o.go("home")},function(){var o=e.simple().content(err).action("OK").highlightAction(!1).position(t.getToastPosition());e.show(o).then(function(){})})},function(){var o=e.simple().content(err).action("OK").highlightAction(!1).position(t.getToastPosition());e.show(o).then(function(){})})},t.googleLogin=function(){a.show({template:'<ion-spinner icon="android"></ion-spinner>'}),n.login().then(function(){s.set("isSignedIn",!0);var i=e.simple().content("YOU HAVE BEEN SIGNED IN").action("").highlightAction(!1).position(t.getToastPosition());e.show(i).then(function(){}),o.go("home"),a.hide()},function(o){var i=e.simple().content("COULD NOT SIGN IN. "+o).action("OK").highlightAction(!1).position(t.getToastPosition());e.show(i).then(function(){}),a.hide()})}}]),OlaTourerController.controller("DestController",["$scope","$timeout","$mdToast","$state","SessionStorageService","LocalStorageService",function(t,e,o,i,n,a){t.toastPosition={bottom:!0,top:!1,left:!0,right:!0},t.getToastPosition=function(){return Object.keys(t.toastPosition).filter(function(e){return t.toastPosition[e]}).join(" ")},t.$on("$ionicView.enter",function(){t.scaleOut=!1,t.selectedPlaces=JSON.parse(a.get("savedTrips"))}),t.itiDetails=function(t){i.go("itinerary",{itineraryName:JSON.stringify(t)}),console.log(t)},t.trips=a.get("savedTrips"),t.submitData=function(a,s){if(s){var r=angular.copy(a);try{t.scaleOut=!0,n.set("lat",r.place.geometry.bounds.Ca.k),n.set("lng",r.place.geometry.bounds.va.j),n.set("place",r.place.formatted_address),e(function(){i.go("pickPlaces")},500)}catch(c){var l=o.simple().content("SOMETHING WENT WRONG! TRY AGAIN").action("OK").highlightAction(!1).position(t.getToastPosition());o.show(l).then(function(){})}}else{var l=o.simple().content("PLACE IS REQUIRED").action("OK").highlightAction(!1).position(t.getToastPosition());o.show(l).then(function(){})}}}]),OlaTourerController.controller("PlacesController",["$scope","$mdToast","$mdBottomSheet","$state","PlacesService","SessionStorageService","cityData","shoppingData","foodData","nightLifeData","ShareService",function(t,e,o,i,n,a,s,r,c,l){t.toastPosition={bottom:!0,top:!1,left:!0,right:!0},t.place=a.get("place"),t.getToastPosition=function(){return Object.keys(t.toastPosition).filter(function(e){return t.toastPosition[e]}).join(" ")},t.moreDataCanBeLoaded=!0,t.cityPaginateData=s.next_page_token,t.shoppingPaginateData=r.next_page_token,t.foodPaginateData=c.next_page_token,t.nightPaginateData=l.next_page_token,t.relaxList=[],t.emeList=[],t.cityPlacesList=[],t.shoppingList=[],t.foodList=[],t.nightLifeList=[],t.cityPlacesList=s.results,t.shoppingList=r.results,t.foodList=c.results,t.nightLifeList=l.results,t.loadMore=function(e,o,i){console.log(i),n.getPlaces(e,o).then(function(e){return"city"==i?(t.cityPlacesList=t.cityPlacesList.concat(e.results),t.cityPaginateData=e.next_page_token,void t.$broadcast("scroll.infiniteScrollComplete")):void("shop"==i&&(t.shoppingList=t.shoppingList.concat(e.results),t.shoppingPaginateData=e.next_page_token))},function(){})},t.plcToRelax=function(e){n.getPlaces(e).then(function(e){t.relaxList=e.results})},t.emePlc=function(e){n.getPlaces(e).then(function(e){t.emeList=e.results})},t.submitCheckedItems=function(){var o=new Array;o=o.concat(t.cityPlacesList,t.shoppingList,t.foodList,t.nightLifeList,t.relaxList,t.emeList);var s=n.checkCat(o);if(a.setObject("selectedPlaces",s),s.length>0)if(s.length>8){var r=e.simple().content("MAX OF 8 PLACES PER TRIP!").action("OK").highlightAction(!1).position(t.getToastPosition());e.show(r).then(function(){})}else i.go("showMap");else{var r=e.simple().content("SELECT AT LEAST ONE").action("OK").highlightAction(!1).position(t.getToastPosition());e.show(r).then(function(){})}},t.showShareSheet=function(t){o.show({templateUrl:"templates/share.html",controller:"ShareBottomSheetCtrl",targetEvent:t}).then(function(){})}}]),OlaTourerController.controller("ShareBottomSheetCtrl",["$scope","$mdBottomSheet","ShareService","SessionStorageService",function(t,e,o,i){t.sharePlatforms=[{name:"Hangouts",icon:"hangouts",platform:"hangouts"},{name:"Facebook",icon:"facebook",platform:"facebook"},{name:"Twitter",icon:"twitter",platform:"twitter"},{name:"WhatsApp",icon:"whatsapp",platform:"whatsapp"},{name:"Cancel",icon:"cancel",platform:"cancel"}],t.share=function(t){e.hide();var n=i.get("place");switch(t){case"facebook":o.shareViaFB("Hey! Suggest me some awesome places to visit on my trip to "+n);break;case"whatsapp":o.shareViaWhatsApp("Hey! Suggest me some awesome places to visit on my trip to "+n);break;case"hangouts":o.shareViaHangouts("Hey! Suggest me some awesome places to visit on my trip to "+n);break;case"twitter":o.shareViaTwitter("Hey! Suggest me some awesome places to visit on my trip to "+n);break;default:e.hide()}}}]),OlaTourerController.controller("ShowMapController",["$scope","SessionStorageService","$stateParams","$mdDialog","$mdToast","$state","$ionicLoading","$timeout","LocalStorageService","$timeout",function(t,e,o,i,n,a,s,r,c,r){function l(t,e){new google.maps.Marker({position:t,map:h,icon:e})}function p(){for(var o=[],i=new Array,a=0;a<t.places.length;a++)i.push(t.places[a].location);for(var a=0;a<i.length;a++)stop=new google.maps.LatLng(i[a].lat,i[a].lng),0!=a&&a!=i.length-1&&l(stop,"img/mid.png"),o.push({location:stop,stopover:!0});start=new google.maps.LatLng(t.places[0].location.lat,t.places[0].location.lng),end=new google.maps.LatLng(t.places[t.places.length-1].location.lat,t.places[t.places.length-1].location.lng),l(start,"img/start.png"),l(end,"img/start.png");var s={origin:start,destination:end,waypoints:o,optimizeWaypoints:!0,travelMode:google.maps.DirectionsTravelMode.DRIVING};t.distance=0,t.traveltime=0,t.cost=0,u.route(s,function(o,i){if(i==google.maps.DirectionsStatus.OK){e.setObject("routeOrder",o.routes[0].waypoint_order);for(var a=0;a<o.routes[0].legs.length;a++)t.distance+=o.routes[0].legs[a].distance.value,t.traveltime+=o.routes[0].legs[a].duration.value;console.log(o),t.distance=(t.distance/1e3).toFixed(1),t.traveltime=(t.traveltime/60).toFixed(1),t.$apply(),directionsDisplay.setDirections(o);{o.routes[0]}}else{var s=n.simple().content("maximum of 8 places").action("OK").highlightAction(!1).position(t.getToastPosition());n.show(s).then(function(){})}})}function g(){directionsDisplay=new google.maps.DirectionsRenderer({suppressMarkers:!0});var t={zoom:17,mapTypeId:google.maps.MapTypeId.ROADMAP};h=new google.maps.Map(document.getElementById("map-canvas"),t),directionsDisplay.setMap(h),p()}s.show({template:'<ion-spinner icon="android"></ion-spinner>'}),t.showAnim=!1,t.places=e.getObject("selectedPlaces"),t.selectedPlaces=JSON.parse(e.get("selectedPlaces")),t.hasTripName=!1,t.toastPosition={bottom:!0,top:!1,left:!0,right:!0},t.getToastPosition=function(){return Object.keys(t.toastPosition).filter(function(e){return t.toastPosition[e]}).join(" ")},t.startpoint=[],t.endpoint=[],t.waypoints=[];var h,u=new google.maps.DirectionsService;t.$on("$ionicView.enter",function(){r(function(){if(t.places&&t.places.length>0)g();else{var e=n.simple().content("SOMETHING WENT WRONG! TRY AGAIN").action("OK").highlightAction(!1).position(t.getToastPosition());n.show(e).then(function(){})}s.hide()},1500)}),t.save=function(o){t.hasTripName=!0;for(var i=JSON.parse(e.get("routeOrder")),n=e.get("place"),a=new Array,s=0;s<i.length;s++)a.push(t.places[i[s]]);var l={name:o||"My Trip To "+n,main:n,plc:a},p=c.getObject("savedTrips");p.unshift(l),c.setObject("savedTrips",p),r(function(){t.showAnim=!0},500)}}]),OlaTourerController.controller("ItineraryDetailsController",["$scope","$mdBottomSheet","$stateParams",function(t,e,o){t.$on("$ionicView.enter",function(){t.itiDet=JSON.parse(o.itineraryName)}),t.showShareSheet=function(t){e.show({templateUrl:"templates/share.html",controller:"ShareBottomSheetCtrl",targetEvent:t}).then(function(){})}}]);